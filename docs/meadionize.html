<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
  <!--Converted with LaTeX2HTML 2002-2-1 (1.71)
  original version by: Nikos Drakos, CBLU, University of Leeds
  * revised and updated by: Marcus Hennecke, Ross Moore, Herb Swan
  * with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
  <title>Meadionize Plugin for VMD, version 1.2.</title>
  <meta name="description" content="Meadionize Plugin for VMD, version 1.2."/>
  <meta name="keywords" content="meadionize"/>
  <meta name="resource-type" content="document"/>
  <meta name="distribution" content="global"/>
  <meta http-equiv="Content-Style-Type" content="text/css"/>
</head>

<body>
<div style="text-align: justify; font-family: helvetica,arial,sans-serif;" class="navigation">
<h1><a name="SECTION00000010000000000000">Meadionize plugin, version 1.2<br/>
</a></h1>
<span style="font-weight: bold; color: rgb(255, 0, 0);"></span></div>

<h4 style="text-align: justify; font-family: helvetica,arial,sans-serif;"><a name="SECTION00000020000000000000">Why Meadionize? <br/>
</a></h4>

<div style="text-align: justify; font-family: helvetica,arial,sans-serif;">
Meadionize is an improved version of the <a style="font-weight: bold;" href="http://www.ks.uiuc.edu/Research/vmd/plugins/autoionize/">Autoionize</a>
plugin for VMD. Autoionize randomly places sodium and chlorine counterions
around a solvated molecule. Autoionize has been designed for molecules with
small net charges, where the electrostatic interactions between the molecule
and the counterions are relatively weak, and the molecular structure and
function are not sensitive to the counterion distribution. That is not the case
for highly charged systems, most notably nucleic acids, which are surrounded by
a clowd of counterions; correct simulations of these systems require placing
ions according to the electrostatic potential of the molecule. Meadionize
addresses this problem by placing the ions into the minima of the electrostatic
potential map generated by the <span style="font-style: italic;">'potential'</span> utility of the MEAD program package by \Donald Bashford by solving the Poisson-Boltzmann equation. Meadionize
accepts all MEAD configuration parameters, generates all necessary input files
for the potential program, executes it, and uses its output to place the
counterions. <span style="color: rgb(255, 0, 0); font-weight: bold;">New:</span> Meadionize
version 1.2 can now add divalent ions. </div>

<h4 style="text-align: justify; font-family: helvetica,arial,sans-serif;"><a name="SECTION00000030000000000000">Installation</a> </h4>

<div style="text-align: justify; font-family: helvetica,arial,sans-serif;">
Create a directory for Meadionize: e.g., under your home directory <br/>
</div>

<div style="text-align: justify; font-family: helvetica,arial,sans-serif;">
</div>

<p style="text-align: justify; font-family: helvetica,arial,sans-serif;margin-left:2em;"><span style="font-style: italic;">mkdir $HOME/meadionize</span> </p>

<p style="text-align: justify; font-family: helvetica,arial,sans-serif;">Download
and save files <a style="font-weight: bold;" href="../files/meadionize.tcl">meadionize.tcl</a> (the main script), <a style="font-weight: bold;" href="../files/ions.top">ions.top</a> (the ion
topology), and <a style="font-weight: bold;" href="../files/pkgIndex.tcl">pkgIndex.tcl</a> (the package index that tells VMD
where to look for the package) into that directory. Add the following two lines
to your $HOME/.vmdrc file (create one if you do not have it): </p>

<div style="text-align: justify; font-family: helvetica,arial,sans-serif;">
</div>

<p style="text-align: justify; font-family: helvetica,arial,sans-serif;margin-left:2em;"><span style="font-style: italic;">global env</span> </p>

<div style="text-align: justify; font-family: helvetica,arial,sans-serif;">
</div>

<p style="text-align: justify; font-family: helvetica,arial,sans-serif;margin-left:2em;"><span style="font-style: italic;">lappend auto_path $env(HOME)/meadionize</span> </p>

<div style="text-align: justify; font-family: helvetica,arial,sans-serif;">
</div>

<p style="text-align: justify; font-family: helvetica,arial,sans-serif;">Then,
download and install the MEAD program package following
the included installation instructions. [UPDATE: MEAD is no longer available from Donald Bashford's page at St. Jude Hospital; instead, please download a copy of the source code fromÂ <a href="https://github.com/balabin/MEAD_2.2.9"><b>GitHub</b></a>.</p>

<div style="text-align: justify; font-family: helvetica,arial,sans-serif;">
</div>

<h4 style="text-align: justify; font-family: helvetica,arial,sans-serif;"><a name="SECTION00000040000000000000">Usage</a> </h4>

<div style="text-align: justify; font-family: helvetica,arial,sans-serif;">
Like all other VMD plugins, you first need to load Meadionize into VMD. Type
the following command in the VMD console (better yet, <a style="font-weight: bold;" href="http://www.ks.uiuc.edu/Research/vmd/plugins/vmdtkcon/">Tk console</a>):
<br/>
</div>

<p style="text-align: justify; font-family: helvetica,arial,sans-serif;margin-left:2em;"><span style="font-style: italic;">package require meadionize</span> </p>

<div style="text-align: justify; font-family: helvetica,arial,sans-serif;">
</div>

<p style="text-align: justify; font-family: helvetica,arial,sans-serif;">This
command actually loads Meadionize into VMD and displays the installed plugin
version. Run '<span style="font-style: italic;">meadionize</span>' with no
parameters to get brief help on Meadionize syntax. Meadionize requires the
following mandatory parameters: the PSF (structure) file name, the PDB
(coordinate) file name, the Charmm parameter file name, positive and negative
ion types (as of this point,<!-- MATH
$\ensuremath{\operatorname{Na}}^+$
--> <span class="MATH"><img src="img1.png" alt="$ \ensuremath{\operatorname{Na}}^+$" align="bottom" border="0" height="17" width="33"/></span> , <span class="MATH"><img src="img2.png" alt="$ K^+$" align="bottom" border="0" height="16" width="28"/></span> ,<!-- MATH
$\ensuremath{\operatorname{Ca}}^{2 +}$
--> <span class="MATH"><img src="img3.png" alt="$ \ensuremath{\operatorname{Ca}}^{2 +}$" align="bottom" border="0" height="17" width="39"/></span> ,<!-- MATH
$\ensuremath{\operatorname{Mg}}^{2 +}$
--> <span class="MATH"><img src="img4.png" alt="$ \ensuremath{\operatorname{Mg}}^{2 +}$" align="middle" border="0" height="37" width="43"/></span> , and <!-- MATH
$\ensuremath{\operatorname{Cl}}^-$
--><span class="MATH"><img src="img5.png" alt="$ \ensuremath{\operatorname{Cl}}^-$" align="bottom" border="0" height="17" width="30"/></span> ions are supported), and either ionic strength, or explicit
numbers of the positive and negative ions to add. Other parameters are
optional; their default values rarely need to be changed, except the fg option
(fine grid resolution), which may need to be increased to <span class="MATH"><img src="img6.png" alt="$ 0.5 - 1.0$" align="middle" border="0" height="29" width="63"/></span>A when running Meadionize on machines with low
RAM and/or adding ions to an exceptionally large system. This is an example of
Meadionize command line: <br/>
</p>

<div style="text-align: justify; font-family: helvetica,arial,sans-serif;">
</div>

<p style="text-align: justify; font-family: helvetica,arial,sans-serif;margin-left:2em;"><span style="font-style: italic;">meadionize -psf solvated.psf -pdb solvated.pdb -par
par_all27_prot_lipid.prm -ipos na -ineg cl -is 0.1</span> </p>

<div style="text-align: justify; font-family: helvetica,arial,sans-serif;">
</div>

<p style="text-align: justify; font-family: helvetica,arial,sans-serif;">Since
calculating the electrostatic potential map for large molecules can take hours,
it is recommended to run Meadionize using VMD in the text-only mode. To do
that, one needs to copy the above two command lines into a file (e.g.,
do_ionize.tcl), add a command <span style="font-style: italic;">'quit</span>'
to the end of the file to tell VMD to stop after executing Meadionize, and run
the following command in the UNIX shell (csh or tcsh): <br/>
</p>

<div style="text-align: justify; font-family: helvetica,arial,sans-serif;">
</div>

<p style="text-align: justify; font-family: helvetica,arial,sans-serif;margin-left:2em;"><span style="font-style: italic;">vmd -dispdev text &lt; do_ionize.tcl &gt;&amp;
do_ionize.log &amp;</span> </p>

<div style="text-align: justify; font-family: helvetica,arial,sans-serif;">
</div>

<p style="text-align: justify; font-family: helvetica,arial,sans-serif;">For
bash or ksh, the shell command syntax is slightly different: <br/>
</p>

<div style="text-align: justify; font-family: helvetica,arial,sans-serif;">
</div>

<p style="text-align: justify; font-family: helvetica,arial,sans-serif;margin-left:2em;"><span style="font-style: italic;">vmd -dispdev text &lt; do_ionize.tcl &gt;
do_ionize.log 2&gt;&amp;1 &amp;</span> </p>

<div style="text-align: justify; font-family: helvetica,arial,sans-serif;">
</div>

<p style="text-align: justify; font-family: helvetica,arial,sans-serif;">To
monitor Meadionize in real time, use the following command (any shell): <br/>
</p>

<div style="text-align: justify; font-family: helvetica,arial,sans-serif;">
</div>

<p style="text-align: justify; font-family: helvetica,arial,sans-serif;margin-left:2em;"><span style="font-style: italic;">tail -f do_ionize.log</span><br/>
</p>

<div style="text-align: justify; font-family: helvetica,arial,sans-serif;">
</div>

<h4 style="text-align: justify; font-family: helvetica,arial,sans-serif;"><a name="SECTION00000050000000000000">Output</a> </h4>

<div style="text-align: justify; font-family: helvetica,arial,sans-serif;">
Meadionize prints out diagnostic messages about performed steps as well as
repeats messages from the potential utility. Often, these messages include the
following warnings: </div>

<p style="text-align: justify; font-family: helvetica,arial,sans-serif;">WARNING:
SAVanal_calc: vertex found with count = 2 </p>

<div style="text-align: justify; font-family: helvetica,arial,sans-serif;">
</div>

<p style="text-align: justify; font-family: helvetica,arial,sans-serif;">WARNING:
SAVanal_calc: vertex found with count = 2 </p>

<div style="text-align: justify; font-family: helvetica,arial,sans-serif;">
</div>

<p style="text-align: justify; font-family: helvetica,arial,sans-serif;">WARNING:
SAVanal_calc: vertex found with count = 1 </p>

<div style="text-align: justify; font-family: helvetica,arial,sans-serif;">
</div>

<p style="text-align: justify; font-family: helvetica,arial,sans-serif;">These
warnings are harmless, and arise from numerical degeneracies in the calculation
of the molecular surface (see You and Bashford, <i>J. Comp. Chem.</i>
<b>16</b>, 743 (1995)). Don Bashford explains these warnings in more details in
his post on the <a style="font-weight: bold;" href="http://www.ccl.net/cgi-bin/ccl/message.cgi?2003+02+27+002">Computational
Chemistry List</a>. </p>

<div style="text-align: justify; font-family: helvetica,arial,sans-serif;">
</div>

<h4 style="text-align: justify; font-family: helvetica,arial,sans-serif;"><a name="SECTION00000060000000000000">Algorithm</a> </h4>

<div style="text-align: justify; font-family: helvetica,arial,sans-serif;">
Meadionize performs the following basic steps: </div>
<dl style="text-align: justify; font-family: helvetica,arial,sans-serif;" compact="compact">
  <dt>1. If an ionic strength is requested, Meadionize finds the number of
  water molecules and calculates the numbers of the positive and negative ions
  (alternatively, these numbers are given as command line parameters). </dt>
    <dd><br/>
    </dd>
  <dt>2. Prepares necessary input files and calls the '<span style="font-style: italic;">potential</span>' utility of the MEAD package to
  solve the Poisson-Boltzmann equation and calculate the electrostatic
  potential map. </dt>
    <dd><br/>
    </dd>
  <dt>3. In a random order, replaces the water molecules at the electrostatic
  potential minima (for positive ions) or maxima (for negative ions) with the
  corresponding ions. Each time, the new ion is placed so that a minimum
  distance between any two ions, as well as a minimum distance between any ion
  and themolecule, are maintained. </dt>
</dl>

<div style="text-align: justify; font-family: helvetica,arial,sans-serif;">
At the first step, Meadionize computes the numbers of positive and negative
ions from two conditions: zero net charge of the system and the ionic strength:
</div>
<ul style="text-align: justify; font-family: helvetica,arial,sans-serif;">
  <li><!-- MATH
    $n_- z_- - n_+ z_+ = Q_{\ensuremath{\operatorname{mol}}}$
    -->
    <span class="MATH"><img src="img7.png" alt="$ n_- z_- - n_+ z_+ = Q_{\ensuremath{\operatorname{mol}}}$" align="middle" border="0" height="30" width="154"/></span> , where <span class="MATH"><img src="img8.png" alt="$ n_-$" align="middle" border="0" height="29" width="23"/></span> (<span class="MATH"><img src="img9.png" alt="$ n_+$" align="middle" border="0" height="29" width="23"/></span> ) and
    <span class="MATH"><img src="img10.png" alt="$ z_-$" align="middle" border="0" height="29" width="21"/></span> (<span class="MATH"><img src="img11.png" alt="$ z_+$" align="middle" border="0" height="29" width="21"/></span> ) are numbers and charges of the negative (positive)
    ions, respectively, and<!-- MATH
    $Q_{\ensuremath{\operatorname{mol}}}$
    --> <span class="MATH"><img src="img12.png" alt="$ Q_{\ensuremath{\operatorname{mol}}}$" align="middle" border="0" height="30" width="37"/></span> is the net charge of the molecule before
    adding ions. </li>
  <li><!-- MATH
    $n_- z^{^{} 2}_- + n_+ z^2_+ = 2 N_{\ensuremath{\operatorname{is}}}$
    -->
    <span class="MATH"><img src="img13.png" alt="$ n_- z^{^{} 2}_- + n_+ z^2_+ = 2 N_{\ensuremath{\operatorname{is}}}$" align="middle" border="0" height="34" width="150"/></span> , where<!-- MATH
    $N_{\ensuremath{\operatorname{is}}}$
    --> <span class="MATH"><img src="img14.png" alt="$ N_{\ensuremath{\operatorname{is}}}$" align="middle" border="0" height="30" width="25"/></span> is a quantity proportional to the total
    number of ions, a function of the requested ionic strength. </li>
</ul>

<div style="text-align: justify; font-family: helvetica,arial,sans-serif;">
<!-- MATH
$N_{\ensuremath{\operatorname{is}}} = C N_A V_{H_2 O}$
-->
In the second condition, <span class="MATH"><img src="img15.png" alt="$ N_{\ensuremath{\operatorname{is}}} = C N_A V_{H_2 O} $" align="middle" border="0" height="30" width="119"/></span> , where <span class="MATH"><img src="img16.png" alt="$ C$" align="bottom" border="0" height="14" width="16"/></span><!-- MATH
$N_A = 6.022 \cdot 10^{23}$
--> is the ionic strength (mol), <span class="MATH"><img src="img17.png" alt="$ N_A = 6.022 \cdot 10^{23}$" align="middle" border="0" height="34" width="125"/></span> is the Avogadro number, and <span class="MATH"><img src="img18.png" alt="$ V_{H_2 O}$" align="middle" border="0" height="30" width="40"/></span><!-- MATH
$V_{H_2
O} = N_{H_2 O} / \rho = N_{H_2 O} m_{H_2 O} / \rho_m$
-->is the water volume (L). The latter can be represented as <span class="MATH"><img src="img19.png" alt="$ V_{H_2 O} = N_{H_2 O} / \rho = N_{H_2 O} m_{H_2 O} / \rho_m$" align="middle" border="0" height="32" width="249"/></span> , where <span class="MATH"><img src="img20.png" alt="$ N_{H_2 O}$" align="middle" border="0" height="30" width="43"/></span> is the number of water molecules in the system,
<span class="MATH"><img src="img21.png" alt="$ \rho$" align="middle" border="0" height="29" width="11"/></span><!-- MATH
$\rho_m = 0.982 g / \ensuremath{\operatorname{cm}}^3$
--> is the volume water density, <span class="MATH"><img src="img22.png" alt="$ \rho_m = 0.982 g / \ensuremath{\operatorname{cm}}^3$" align="middle" border="0" height="34" width="127"/></span> is the mass water density (TIP3
water model, Jorgensen <i>et al</i>, <i>J. Chem. Phys.</i> <b>79</b><!-- MATH
$m_{H_2 O} = 18 \cdot 1.67262 \cdot 10^{- 24}
g$
-->, 926 (1983)), and <span class="MATH"><img src="img23.png" alt="$ m_{H_2 O} = 18 \cdot 1.67262 \cdot 10^{- 24} g$" align="middle" border="0" height="34" width="204"/></span> is the water molecule mass.
Combining the above, one obtains the following formulas: </div>
<ul style="text-align: justify; font-family: helvetica,arial,sans-serif;">
  <li><!-- MATH
    $N_{\ensuremath{\operatorname{is}}} = 0.01846 C N_{H_2 O}$
    -->
    <span class="MATH"><img src="img24.png" alt="$ N_{\ensuremath{\operatorname{is}}} = 0.01846 C N_{H_2 O}$" align="middle" border="0" height="30" width="151"/></span> </li>
  <li><!-- MATH
    $\left. n_+ = [ 2 N_{\ensuremath{\operatorname{is}}} - Q_{\ensuremath{\operatorname{mol}}} z_- \right] / [ z_+
    \left( z_+ + z_- \right)]$
    -->
    <span class="MATH"><img src="img25.png" alt="$ \left. n_+ = [ 2 N_{\ensuremath{\operatorname{is}}} - Q_{\ensuremath{\operatorname{mol}}} z_- \right] / [ z_+ \left( z_+ + z_- \right)]$" align="middle" border="0" height="32" width="265"/></span> </li>
  <li><!-- MATH
    $n_- = \left[ Q_{\ensuremath{\operatorname{mol}}} + n_+ z_+] / z_- \right.$
    -->
    <span class="MATH"><img src="img26.png" alt="$ n_- = \left[ Q_{\ensuremath{\operatorname{mol}}} + n_+ z_+] / z_- \right.$" align="middle" border="0" height="32" width="173"/></span></li>
</ul>

<div style="text-align: justify; font-family: helvetica,arial,sans-serif;">
</div>

<h4 style="text-align: justify; font-family: helvetica,arial,sans-serif;"><a name="SECTION00000070000000000000">License</a> </h4>

<div style="text-align: justify; font-family: helvetica,arial,sans-serif;">
Meadionize is released under the <a style="font-weight: bold;" href="http://www.gnu.org/copyleft/gpl.html">GNU public license</a> version 3 or
later. IAB thanks Don Bashford for making MEAD available to the biomedical
research community. All comments, suggestions, and bug reports are very
welcome. <span class="MATH"></span></div>
<br/>

<hr/>

<br/>
</body>
</html>